-- MySQL Script generated by MySQL Workbench
-- Mon May 28 21:21:44 2018
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `mydb` ;

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`artists`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`artists` ;

CREATE TABLE IF NOT EXISTS `mydb`.`artists` (
  `artistId` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`artistId`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`albums`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`albums` ;

CREATE TABLE IF NOT EXISTS `mydb`.`albums` (
  `albumId` INT NOT NULL AUTO_INCREMENT,
  `artistId` INT NULL,
  `title` VARCHAR(255) NOT NULL,
  `year` INT NULL,
  `genre` VARCHAR(45) NULL,
  `cover` BLOB NULL,
  PRIMARY KEY (`albumId`),
  INDEX `fkAlbumsArtists_idx` (`artistId` ASC),
  CONSTRAINT `fkAlbumsArtists`
    FOREIGN KEY (`artistId`)
    REFERENCES `mydb`.`artists` (`artistId`)
    ON DELETE CASCADE
    ON UPDATE RESTRICT)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`songs`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`songs` ;

CREATE TABLE IF NOT EXISTS `mydb`.`songs` (
  `songId` INT NOT NULL AUTO_INCREMENT,
  `artistId` INT NULL,
  `albumId` INT NULL,
  `trackNum` INT NULL,
  `title` VARCHAR(255) NOT NULL,
  `duration` INT NULL,
  PRIMARY KEY (`songId`),
  INDEX `fkSongsArtists_idx` (`artistId` ASC),
  INDEX `fkSongsAlbums_idx` (`albumId` ASC),
  CONSTRAINT `fkSongsArtists`
    FOREIGN KEY (`artistId`)
    REFERENCES `mydb`.`artists` (`artistId`)
    ON DELETE CASCADE
    ON UPDATE RESTRICT,
  CONSTRAINT `fkSongsAlbums`
    FOREIGN KEY (`albumId`)
    REFERENCES `mydb`.`albums` (`albumId`)
    ON DELETE CASCADE
    ON UPDATE RESTRICT)
ENGINE = InnoDB;

USE `mydb` ;

-- -----------------------------------------------------
-- Placeholder table for view `mydb`.`albumsView`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`albumsView` (`albumId` INT, `artistId` INT, `artist` INT, `title` INT, `year` INT);

-- -----------------------------------------------------
-- View `mydb`.`albumsView`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`albumsView`;
DROP VIEW IF EXISTS `mydb`.`albumsView` ;
USE `mydb`;
CREATE  OR REPLACE VIEW `albumsView` AS
SELECT A.`albumId`, A.`artistId`, B.`name` AS `artist`, A.`title`, A.`year` FROM `albums` AS A
LEFT JOIN `artists` AS B
ON A.`artistId` = B.`artistId`
ORDER BY A.`title`;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `mydb`.`artists`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`artists` (`artistId`, `name`) VALUES (1, 'Madonna');
INSERT INTO `mydb`.`artists` (`artistId`, `name`) VALUES (2, 'Masterboy');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`albums`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`albums` (`albumId`, `artistId`, `title`, `year`, `genre`, `cover`) VALUES (1, NULL, 'Miscellaneous', NULL, NULL, NULL);
INSERT INTO `mydb`.`albums` (`albumId`, `artistId`, `title`, `year`, `genre`, `cover`) VALUES (2, 1, 'American Life', 2002, 'Pop', NULL);
INSERT INTO `mydb`.`albums` (`albumId`, `artistId`, `title`, `year`, `genre`, `cover`) VALUES (3, 2, 'Different Dreams', 2000, 'Techno', NULL);

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`songs`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`songs` (`songId`, `artistId`, `albumId`, `trackNum`, `title`, `duration`) VALUES (1, 1, 2, 1, 'American Life', 297);
INSERT INTO `mydb`.`songs` (`songId`, `artistId`, `albumId`, `trackNum`, `title`, `duration`) VALUES (2, 1, 2, 2, 'Hollywood', 264);
INSERT INTO `mydb`.`songs` (`songId`, `artistId`, `albumId`, `trackNum`, `title`, `duration`) VALUES (3, 1, 2, 3, 'I\'m So Stupid', 248);
INSERT INTO `mydb`.`songs` (`songId`, `artistId`, `albumId`, `trackNum`, `title`, `duration`) VALUES (4, 1, 2, 4, 'Love Profusion', 217);
INSERT INTO `mydb`.`songs` (`songId`, `artistId`, `albumId`, `trackNum`, `title`, `duration`) VALUES (5, 1, 2, 5, 'Nobody Knows me', 279);
INSERT INTO `mydb`.`songs` (`songId`, `artistId`, `albumId`, `trackNum`, `title`, `duration`) VALUES (6, 1, 2, 6, 'Nothing Fails', 288);
INSERT INTO `mydb`.`songs` (`songId`, `artistId`, `albumId`, `trackNum`, `title`, `duration`) VALUES (7, 1, 2, 7, 'Intervention', 294);
INSERT INTO `mydb`.`songs` (`songId`, `artistId`, `albumId`, `trackNum`, `title`, `duration`) VALUES (8, 1, 2, 8, 'X-Static Process', 289);
INSERT INTO `mydb`.`songs` (`songId`, `artistId`, `albumId`, `trackNum`, `title`, `duration`) VALUES (9, 1, 2, 9, 'Mother And Father', 273);
INSERT INTO `mydb`.`songs` (`songId`, `artistId`, `albumId`, `trackNum`, `title`, `duration`) VALUES (10, 1, 2, 10, 'Die Another Day', 278);
INSERT INTO `mydb`.`songs` (`songId`, `artistId`, `albumId`, `trackNum`, `title`, `duration`) VALUES (11, 1, 2, 11, 'Easy Ride', 305);
INSERT INTO `mydb`.`songs` (`songId`, `artistId`, `albumId`, `trackNum`, `title`, `duration`) VALUES (12, 2, 3, 8, 'Feel the Heat of the Night', 276);

COMMIT;

